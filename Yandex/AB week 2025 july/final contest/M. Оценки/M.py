'''
M. Оценки

Вам даны данные следующего формата: для каждого события зафиксирован идентификатор пользователя (user_id) и сумма транзакции (gmv). Поскольку один пользователь может совершить несколько транзакций, исходные данные представляют собой детализированные (пособитийные), а не агрегированные (поюзерные) данные.

Сагрегируйте данные до пользователя (тип агрегации: сумма). Найдите несмещённую оценку матожидания (выборочное среднее) и дисперсии.

Используйте данные из файла synthetic_gmv_data_1.1.csv

to download dataset: https://github.com/dakhakimova/YSDA_ABweek/blob/d4a7c8bcc26d30a2e469d580911a0986c1e1f98b/synthetic_gmv_data_1.1.csv

Формат вывода

В ответе выведите два числа через пробел. Целую и дробную часть разделяйте точкой.

Пример ответа: 2.008 2.018

Примечания

Округлите до 3‑го знака после точки.
'''


import pandas as pd

# 1. Загрузка подробных (event-level) данных
df = pd.read_csv('synthetic_gmv_data_1.1.csv')  # убедитесь, что файл в той же папке, где запускаете скрипт

# 2. Агрегация по пользователям (суммирование GMV по каждому user_id)
df_user = df.groupby('user_id', as_index=False)['gmv'].sum()

# 3. Вычисление несмещённой оценки матожидания (выборочное среднее) и дисперсии
mean_gmv = df_user['gmv'].mean()
var_gmv = df_user['gmv'].var(ddof=1)  # ddof=1 для несмещённой оценки

# 4. Вывод результата с округлением до трёх знаков после точки
print(f"{mean_gmv:.3f} {var_gmv:.3f}")


# answer: 2750.847 3646228.409